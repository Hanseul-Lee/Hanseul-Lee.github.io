
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="HS&#39;s blog">
    <title>46. async/await - HS&#39;s blog</title>
    <link rel="canonical" href="https://hanseul-lee.github.io/2020/11/15/js-46/">
    <meta name="author" content="Hanseul lee">
    
    
    
        
            <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss2.xml">
        
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Hanseul lee","sameAs":["https://github.com/hanseul-lee/"],"image":"myphoto.jpg"},"articleBody":"\n\n\n1. async/await\nasync/await은 가독성 좋게 비동기 처리를 동기 처리처럼 동작하도록 구현하기 위해 도입되었다.\nasync/await는 프로미스를 기반으로 동작한다. async/await를 사용하면 프로미스의 then/catch/finally 후속 처리 메서드 없이 마치 동기 처리처럼 프로미스가 처리 결과를 반환하도록 구현할 수 있다. \n\n1.1. async 함수\nawait 키워드는 반드시 async 함수 내부에서 사용해야 한다. \nasync 함수는 async 키워드를 사용해 정의하며 언제나 프로미스를 반환한다.(tip) 함수의 맨 앞에 붙여줄 것!\n클래스의 constructor 메서드는 async 메서드가 될 수 없다. 클래스의 constructor 메서드는 인스턴스를 반환해야 하지만 async 함수는 언제나 프로미스를 반환해야 한다.\n\n123456789101112131415161718192021222324// async 함수 선언문async function foo(n) &#123; return n; &#125;foo(1).then(v =&gt; console.log(v)); // 1// async 함수 표현식const bar = async function (n) &#123; return n; &#125;;bar(2).then(v =&gt; console.log(v)); // 2// async 화살표 함수const baz = async n =&gt; n;baz(3).then(v =&gt; console.log(v)); // 3// async 메서드const obj = &#123;  async foo(n) &#123; return n; &#125;&#125;;obj.foo(4).then(v =&gt; console.log(v)); // 4// async 클래스 메서드class MyClass &#123;  async bar(n) &#123; return n; &#125;&#125;const myClass = new MyClass();myClass.bar(5).then(v =&gt; console.log(v)); // 5\n\n\n\n\n1.2. await 함수\nawait 키워드는 프로미스가 settled 상태(비동기 처리가 수행된 상태)가 될 때까지 대기하다가 settled 상태가 되면 프로미스가 resolve한 처리 결과를 반환한다.\nawait 키워드는 다음 실행을 일시 중지시켰다가 프로미스가 settled 상태가 되면 다시 재개한다.\nawait 키워드는 반드시 프로미스 앞에서 사용해야 한다.\n\n\n\n아래 예제에서 ①의 fetch 함수가 수행한 HTTP 요청에 대한 서버의 응답이 도착해서 fetch 함수가 반환한 프로미스가 settled 상태가 될 때까지 ①은 대기하게 된다. 이후 프로미스가 settled 상태가 되면 프로미스가 resolve한 처리 결과가 res 변수에 할당된다.\n123456789const fetch = require(&#x27;node-fetch&#x27;);const getGithubUserName = async id =&gt; &#123;  const res = await fetch(`https://api.github.com/users/$&#123;id&#125;`); // ①  const &#123; name &#125; = await res.json(); // ②  console.log(name); // Ungmo Lee&#125;;getGithubUserName(&#x27;ungmo2&#x27;);\n\n\n\n(🔴주의) 여러 개의 비동기 처리가 연관이 없다면 순차적으로 처리할 필요가 없으므로 Promise.all을 사용하는 것을 추천한다.하지만 비동기 처리의 처리 순서가 보장되어야 할 때는 await 키워드를 순서대로 쓴다.\n\n1234567891011121314151617181920212223242526// 1. 처리 순서의 연관이 없는 경우async function foo() &#123;  const res = await Promise.all([    new Promise(resolve =&gt; setTimeout(() =&gt; resolve(1), 3000)),    new Promise(resolve =&gt; setTimeout(() =&gt; resolve(2), 2000)),    new Promise(resolve =&gt; setTimeout(() =&gt; resolve(3), 1000))  ]);  console.log(res); // [1, 2, 3]&#125;foo(); // 약 3초 소요된다.// 2. 처리 순서가 보장되어야 하는 경우async function bar(n) &#123;  const a = await new Promise(resolve =&gt; setTimeout(() =&gt; resolve(n), 3000));  // 두 번째 비동기 처리를 수행하려면 첫 번째 비동기 처리 결과가 필요하다.  const b = await new Promise(resolve =&gt; setTimeout(() =&gt; resolve(a + 1), 2000));  // 세 번째 비동기 처리를 수행하려면 두 번째 비동기 처리 결과가 필요하다.  const c = await new Promise(resolve =&gt; setTimeout(() =&gt; resolve(b + 1), 1000));  console.log([a, b, c]); // [1, 2, 3]&#125;bar(1); // 약 6초 소요된다.\n\n1.3. 에러처리비동기 처리를 위한 콜백 패턴의 단점 중 가장 심각한 것은 에러 처리가 곤란하다는 것이다. 비동기 함수의 콜백 함수를 호출한 것은 비동기 함수가 아니기 때문에 try…catch 문을 사용해 에러를 캐치할 수 없다. 하지만 async/await에서 에러 처리는 try…catch 문을 사용할 수 있다. 콜백 함수를 인수로 전달받는 비동기 함수와는 달리 프로미스를 반환하는 비동기 함수는 명시적으로 호출할 수 있기 때문에 호출자가 명확하다.\n123456789101112131415const fetch = require(&#x27;node-fetch&#x27;);const foo = async () =&gt; &#123;  try &#123;    const wrongUrl = &#x27;https://wrong.url&#x27;;    const response = await fetch(wrongUrl);    const data = await response.json();    console.log(data);  &#125; catch (err) &#123;    console.error(err); // TypeError: Failed to fetch  &#125;&#125;;foo();\n\n\nasync 함수 내에서 catch 문을 사용해서 에러 처리를 하지 않으면 async 함수는 발생한 에러를 reject하는 프로미스를 반환한다. 따라서 async 함수를 호출하고 Promise.prototype.catch 후속 처리 메서드를 사용해 에러를 캐치할 수도 있다.\n12345678910111213const fetch = require(&#x27;node-fetch&#x27;);const foo = async () =&gt; &#123;  const wrongUrl = &#x27;https://wrong.url&#x27;;  const response = await fetch(wrongUrl);  const data = await response.json();  return data;&#125;;foo()  .then(console.log)  .catch(console.error); // TypeError: Failed to fetch\n\n\n\n\nReference\n\npoiemaweb.com\n","dateCreated":"2020-11-15T15:51:37+09:00","dateModified":"2020-12-10T23:13:23+09:00","datePublished":"2020-11-15T15:51:37+09:00","description":"\nasync/await은 가독성 좋게 비동기 처리를 동기 처리처럼 동작하도록 구현하기 위해 도입되었다. asycn와 await 함수에 대해 알아보자.","headline":"46. async/await","image":["js.png"],"mainEntityOfPage":{"@type":"WebPage","@id":"https://hanseul-lee.github.io/2020/11/15/JS-46/"},"publisher":{"@type":"Organization","name":"Hanseul lee","sameAs":["https://github.com/hanseul-lee/"],"image":"myphoto.jpg","logo":{"@type":"ImageObject","url":"myphoto.jpg"}},"url":"https://hanseul-lee.github.io/2020/11/15/JS-46/","keywords":"javascript","thumbnailUrl":"js.png"}</script>
    <meta name="description" content="async&#x2F;await은 가독성 좋게 비동기 처리를 동기 처리처럼 동작하도록 구현하기 위해 도입되었다. asycn와 await 함수에 대해 알아보자.">
<meta property="og:type" content="blog">
<meta property="og:title" content="46. async&#x2F;await">
<meta property="og:url" content="https://hanseul-lee.github.io/2020/11/15/JS-46/index.html">
<meta property="og:site_name" content="HS&#39;s blog">
<meta property="og:description" content="async&#x2F;await은 가독성 좋게 비동기 처리를 동기 처리처럼 동작하도록 구현하기 위해 도입되었다. asycn와 await 함수에 대해 알아보자.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-11-15T06:51:37.000Z">
<meta property="article:modified_time" content="2020-12-10T14:13:23.228Z">
<meta property="article:author" content="Hanseul lee">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://hanseul-lee.github.io/assets/images/myphoto.jpg">
    
    
        <meta property="og:image" content="https://hanseul-lee.github.io/2020/11/15/JS-46/js.png">
        <meta class="swiftype" name="image" data-type="enum" content="https://hanseul-lee.github.io/2020/11/15/JS-46/js.png">
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="2">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/" aria-label>
            HS&#39;s blog
        </a>
    </div>
    
        
            <a class="header-right-picture " href="#about" aria-label="Open the link: /#about">
        
        
            <img class="header-picture" src="/assets/images/myphoto.jpg" alt="Author&#39;s picture">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="2">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about" aria-label="Read more about the author">
                    <img class="sidebar-profile-picture" src="/assets/images/myphoto.jpg" alt="Author&#39;s picture">
                </a>
                <h4 class="sidebar-profile-name">Hanseul lee</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Hello, I’m Hanseul:)</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/" rel="noopener" title="Home">
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-categories" rel="noopener" title="All-categories">
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">All-categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/category-project" rel="noopener" title="project-log">
                        <i class="sidebar-button-icon fa fa-caret-right" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">project-log</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/category-Fastcampus" rel="noopener" title="study-log">
                        <i class="sidebar-button-icon fa fa-caret-right" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">study-log</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/category-TIL" rel="noopener" title="TIL">
                        <i class="sidebar-button-icon fa fa-caret-right" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">TIL</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="/all-tags" rel="noopener" title="Tags">
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="#about" rel="noopener" title="About">
                        <i class="sidebar-button-icon fa fa-user-circle" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a class="sidebar-button-link " href="https://github.com/hanseul-lee/" target="_blank" rel="external nofollow noopener noreferrer" title="GitHub">
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="2" class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            46. async/await
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-11-15T15:51:37+09:00">
	
		    2020.11.15
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Fastcampus/">Fastcampus</a>, <a class="category-link" href="/categories/Fastcampus/Javascript/">Javascript</a>


    
    <br>

    <span>LastUpdated  </span>
    <time datetime="2020-11-15T15:51:37+09:00">
        
                2020.12.10 23:13:23
            
    </time>

</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <!-- excerpt -->
<h1 id="table-of-contents">Table of Contents</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-async-await"><span class="toc-text">1. async&#x2F;await</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-async-%ED%95%A8%EC%88%98"><span class="toc-text">1.1. async 함수</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-await-%ED%95%A8%EC%88%98"><span class="toc-text">1.2. await 함수</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%EC%97%90%EB%9F%AC%EC%B2%98%EB%A6%AC"><span class="toc-text">1.3. 에러처리</span></a></li></ol></li></ol>

<h1 id="1-async-await"><a href="#1-async-await" class="headerlink" title="1. async/await"></a>1. async/await</h1><ul>
<li>async/await은 가독성 좋게 비동기 처리를 동기 처리처럼 동작하도록 구현하기 위해 도입되었다.</li>
<li>async/await는 프로미스를 기반으로 동작한다. async/await를 사용하면 프로미스의 then/catch/finally 후속 처리 메서드 없이 마치 동기 처리처럼 프로미스가 처리 결과를 반환하도록 구현할 수 있다. </li>
</ul>
<h2 id="1-1-async-함수"><a href="#1-1-async-함수" class="headerlink" title="1.1. async 함수"></a>1.1. async 함수</h2><ul>
<li>await 키워드는 반드시 async 함수 내부에서 사용해야 한다. </li>
<li>async 함수는 async 키워드를 사용해 정의하며 언제나 프로미스를 반환한다.<br>(tip) 함수의 맨 앞에 붙여줄 것!</li>
<li>클래스의 constructor 메서드는 async 메서드가 될 수 없다. 클래스의 constructor 메서드는 인스턴스를 반환해야 하지만 async 함수는 언제나 프로미스를 반환해야 한다.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// async 함수 선언문</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">n</span>) </span>&#123; <span class="keyword">return</span> n; &#125;</span><br><span class="line">foo(<span class="number">1</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// async 함수 표현식</span></span><br><span class="line"><span class="keyword">const</span> bar = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123; <span class="keyword">return</span> n; &#125;;</span><br><span class="line">bar(<span class="number">2</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)); <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// async 화살표 함수</span></span><br><span class="line"><span class="keyword">const</span> baz = <span class="keyword">async</span> n =&gt; n;</span><br><span class="line">baz(<span class="number">3</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)); <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// async 메서드</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="keyword">async</span> foo(n) &#123; <span class="keyword">return</span> n; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">obj.foo(<span class="number">4</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)); <span class="comment">// 4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// async 클래스 메서드</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">  <span class="keyword">async</span> bar(n) &#123; <span class="keyword">return</span> n; &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> myClass = <span class="keyword">new</span> MyClass();</span><br><span class="line">myClass.bar(<span class="number">5</span>).then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v)); <span class="comment">// 5</span></span><br></pre></td></tr></table></figure>
<br>



<h2 id="1-2-await-함수"><a href="#1-2-await-함수" class="headerlink" title="1.2. await 함수"></a>1.2. await 함수</h2><ul>
<li>await 키워드는 프로미스가 settled 상태(비동기 처리가 수행된 상태)가 될 때까지 대기하다가 settled 상태가 되면 프로미스가 resolve한 처리 결과를 반환한다.</li>
<li>await 키워드는 다음 실행을 일시 중지시켰다가 프로미스가 settled 상태가 되면 다시 재개한다.</li>
<li>await 키워드는 반드시 프로미스 앞에서 사용해야 한다.</li>
</ul>
<br>

<p>아래 예제에서 ①의 fetch 함수가 수행한 HTTP 요청에 대한 서버의 응답이 도착해서 fetch 함수가 반환한 프로미스가 settled 상태가 될 때까지 ①은 대기하게 된다. <strong>이후 프로미스가 settled 상태가 되면 프로미스가 resolve한 처리 결과가 res 변수에 할당된다.</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">&#x27;node-fetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> getGithubUserName = <span class="keyword">async</span> id =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> fetch(<span class="string">`https://api.github.com/users/<span class="subst">$&#123;id&#125;</span>`</span>); <span class="comment">// ①</span></span><br><span class="line">  <span class="keyword">const</span> &#123; name &#125; = <span class="keyword">await</span> res.json(); <span class="comment">// ②</span></span><br><span class="line">  <span class="built_in">console</span>.log(name); <span class="comment">// Ungmo Lee</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">getGithubUserName(<span class="string">&#x27;ungmo2&#x27;</span>);</span><br></pre></td></tr></table></figure>
<br>

<ul>
<li>(🔴주의) 여러 개의 비동기 처리가 연관이 없다면 순차적으로 처리할 필요가 없으므로 Promise.all을 사용하는 것을 추천한다.<br>하지만 비동기 처리의 처리 순서가 보장되어야 할 때는 await 키워드를 순서대로 쓴다.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 처리 순서의 연관이 없는 경우</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="number">1</span>), <span class="number">3000</span>)),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="number">2</span>), <span class="number">2000</span>)),</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(<span class="number">3</span>), <span class="number">1000</span>))</span><br><span class="line">  ]);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(res); <span class="comment">// [1, 2, 3]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">foo(); <span class="comment">// 약 3초 소요된다.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 처리 순서가 보장되어야 하는 경우</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">n</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> a = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(n), <span class="number">3000</span>));</span><br><span class="line">  <span class="comment">// 두 번째 비동기 처리를 수행하려면 첫 번째 비동기 처리 결과가 필요하다.</span></span><br><span class="line">  <span class="keyword">const</span> b = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(a + <span class="number">1</span>), <span class="number">2000</span>));</span><br><span class="line">  <span class="comment">// 세 번째 비동기 처리를 수행하려면 두 번째 비동기 처리 결과가 필요하다.</span></span><br><span class="line">  <span class="keyword">const</span> c = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> resolve(b + <span class="number">1</span>), <span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log([a, b, c]); <span class="comment">// [1, 2, 3]</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">bar(<span class="number">1</span>); <span class="comment">// 약 6초 소요된다.</span></span><br></pre></td></tr></table></figure>

<h2 id="1-3-에러처리"><a href="#1-3-에러처리" class="headerlink" title="1.3. 에러처리"></a>1.3. 에러처리</h2><p>비동기 처리를 위한 콜백 패턴의 단점 중 가장 심각한 것은 에러 처리가 곤란하다는 것이다. 비동기 함수의 콜백 함수를 호출한 것은 비동기 함수가 아니기 때문에 try…catch 문을 사용해 에러를 캐치할 수 없다. 하지만 async/await에서 에러 처리는 try…catch 문을 사용할 수 있다. 콜백 함수를 인수로 전달받는 비동기 함수와는 달리 프로미스를 반환하는 비동기 함수는 명시적으로 호출할 수 있기 때문에 호출자가 명확하다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">&#x27;node-fetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> wrongUrl = <span class="string">&#x27;https://wrong.url&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(wrongUrl);</span><br><span class="line">    <span class="keyword">const</span> data = <span class="keyword">await</span> response.json();</span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="built_in">console</span>.error(err); <span class="comment">// TypeError: Failed to fetch</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<br>

<p><strong>async 함수 내에서 catch 문을 사용해서 에러 처리를 하지 않으면 async 함수는 발생한 에러를 reject하는 프로미스를 반환한다.</strong> 따라서 async 함수를 호출하고 Promise.prototype.catch 후속 처리 메서드를 사용해 에러를 캐치할 수도 있다.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fetch = <span class="built_in">require</span>(<span class="string">&#x27;node-fetch&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> wrongUrl = <span class="string">&#x27;https://wrong.url&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(wrongUrl);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> response.json();</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line">  .then(<span class="built_in">console</span>.log)</span><br><span class="line">  .catch(<span class="built_in">console</span>.error); <span class="comment">// TypeError: Failed to fetch</span></span><br></pre></td></tr></table></figure>

<br>

<hr>
<p><strong>Reference</strong></p>
<ul>
<li>poiemaweb.com</li>
</ul>
            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/javascript/" rel="tag">javascript</a>

              </div>
              
              <!-- Comment -->
              
                
                      <script src="https://utteranc.es/client.js" repo="hanseul-lee/blog-comments" issue-term="title" theme="github-light" crossorigin="anonymous" async>
</script>
                  
                
              
                <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/11/16/20-11-16-TIL/" data-tooltip="[미니 프로젝트] 20-11-16 월요일 미니프로젝트 1일차" aria-label="PREVIOUS: [미니 프로젝트] 20-11-16 월요일 미니프로젝트 1일차">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/11/15/20-11-15-TIL/" data-tooltip="20-11-15 일요일 TIL" aria-label="NEXT: 20-11-15 일요일 TIL">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="javascript:history.back()" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                
    </div>
</article>


<!-- Comment -->
<!--  -->

                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 Hanseul lee. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/11/16/20-11-16-TIL/" data-tooltip="[미니 프로젝트] 20-11-16 월요일 미니프로젝트 1일차" aria-label="PREVIOUS: [미니 프로젝트] 20-11-16 월요일 미니프로젝트 1일차">
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/11/15/20-11-15-TIL/" data-tooltip="20-11-15 일요일 TIL" aria-label="NEXT: 20-11-15 일요일 TIL">
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="javascript:history.back()" aria-label="Table of Contents">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/myphoto.jpg" alt="Author&#39;s picture">
        
            <h4 id="about-card-name">Hanseul lee</h4>
        
            <div id="about-card-bio"><p>Hello, I’m Hanseul:)</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>Programmer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br>
                Korea
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
